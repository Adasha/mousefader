"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _createSuper(i){var a=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(i);return _possibleConstructorReturn(this,a?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var i="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function _construct(t,e,i){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,i){var a=[null];a.push.apply(a,e);var s=new(Function.bind.apply(t,a));return i&&_setPrototypeOf(s,i.prototype),s}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classPrivateMethodGet(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function _classPrivateFieldGet(t,e){var i=e.get(t);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(t):i.value}function _classPrivateFieldSet(t,e,i){var a=e.get(t);if(!a)throw new TypeError("attempted to set private field on non-instance");if(a.set)a.set.call(t,i);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=i}return i}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Utils=function t(){_classCallCheck(this,t)};_defineProperty(Utils,"constrain",function(t,e,i){return"number"!=typeof t?NaN:(null!=e&&"number"==typeof e&&(t=Math.max(t,e)),null!=i&&"number"==typeof i&&(t=Math.min(t,i)),t)}),_defineProperty(Utils,"roundTo",function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=Math.pow(e+1,10);return Math.round(t*i)/i}),_defineProperty(Utils,"delta",function(t,e,i){return(i-e)*Utils.constrain(t,0,1)+e}),_defineProperty(Utils,"map",function(t,e,i,a,s){return(t-e)*(s-a)/(i-e)+a}),_defineProperty(Utils,"random",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:2;switch(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"uniform"){case"gaussian":case"normal":for(var e=0,i=0;i<6;i++)e+=(Math.random()-.5)*t;return e/6;case"uniform":default:return(Math.random()-.5)*t}}),_defineProperty(Utils,"XOR",function(t,e){return(t||e)&&!(t&&e)}),_defineProperty(Utils,"isVisibleInViewport",function(t){var e=t.getBoundingClientRect(),i=document.documentElement;return 0<=e.right&&e.left<=i.clientWidth&&0<=e.bottom&&e.top<=i.clientHeight}),_defineProperty(Utils,"valToObj",function(t){var e={};return e[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value"]=t,e}),_defineProperty(Utils,"isObject",function(t){return t==Object(t)});var _params=new WeakMap,_pointer=new WeakMap,_effects=new WeakMap,_nodes=new WeakMap,_nodeData=new WeakMap,_VALID_DIRECTIONS=new WeakMap,_DEFAULT_DIRECTION=new WeakMap,_DEFAULT_MODE=new WeakMap,_DEFAULT_ACCURACY=new WeakMap,_DEFAULT_FPS=new WeakMap,_DEFAULT_RUNOFF=new WeakMap,_DEFAULT_SCATTER_METHOD=new WeakMap,_VALID_EFFECTS=new WeakMap,_init=new WeakSet,_setNodeIndexData=new WeakSet,ProximityEffect=function(){_inherits(s,_wrapNativeSuper(EventTarget));var a=_createSuper(s);function s(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(_classCallCheck(this,s),e=a.call(this),_setNodeIndexData.add(_assertThisInitialized(e)),_init.add(_assertThisInitialized(e)),_params.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_pointer.set(_assertThisInitialized(e),{writable:!0,value:{}}),_effects.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_nodes.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_nodeData.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_VALID_DIRECTIONS.set(_assertThisInitialized(e),{writable:!0,value:new Set(["both","horizontal","vertical"])}),_DEFAULT_DIRECTION.set(_assertThisInitialized(e),{writable:!0,value:"both"}),_DEFAULT_MODE.set(_assertThisInitialized(e),{writable:!0,value:"redraw"}),_DEFAULT_ACCURACY.set(_assertThisInitialized(e),{writable:!0,value:5}),_DEFAULT_FPS.set(_assertThisInitialized(e),{writable:!0,value:15}),_DEFAULT_RUNOFF.set(_assertThisInitialized(e),{writable:!0,value:100}),_DEFAULT_SCATTER_METHOD.set(_assertThisInitialized(e),{writable:!0,value:"uniform"}),_VALID_EFFECTS.set(_assertThisInitialized(e),{writable:!0,value:{opacity:{min:0,max:1,default:1,rule:"opacity"},translateX:{default:0,rule:"transform",func:"translateX",unit:"px"},translateY:{default:0,rule:"transform",func:"translateY",unit:"px"},translateZ:{default:0,rule:"transform",func:"translateZ",unit:"px"},rotate:{default:0,rule:"transform",func:"rotate",unit:"deg"},rotateX:{default:0,rule:"transform",func:"rotateX",unit:"deg"},rotateY:{default:0,rule:"transform",func:"rotateY",unit:"deg"},rotateZ:{default:0,rule:"transform",func:"rotateZ",unit:"deg"},scale:{default:1,rule:"transform",func:"scale"},scaleX:{default:1,rule:"transform",func:"scaleX"},scaleY:{default:1,rule:"transform",func:"scaleY"},scaleZ:{default:1,rule:"transform",func:"scaleZ"},skewX:{default:0,rule:"transform",func:"skewX",unit:"deg"},skewY:{default:0,rule:"transform",func:"skewY",unit:"deg"},blur:{min:0,default:0,rule:"filter",func:"blur",unit:"px"},brightness:{min:0,default:100,rule:"filter",func:"brightness",unit:"%"},contrast:{min:0,default:100,rule:"filter",func:"contrast",unit:"%"},grayscale:{min:0,max:100,default:0,rule:"filter",func:"grayscale",unit:"%"},hueRotate:{default:0,rule:"filter",func:"hue-rotate",unit:"deg"},invert:{min:0,max:100,default:0,rule:"filter",func:"invert",unit:"%"},saturate:{min:0,max:100,default:100,rule:"filter",func:"saturate",unit:"%"},sepia:{min:0,max:100,default:0,rule:"filter",func:"sepia",unit:"%"},backgroundColor:{min:0,max:255,default:[0,0,0],rule:"backgroundColor",func:"rgb",args:3},scale3D:{default:[1,1,1],rule:"transform",func:"scale3D",args:3}}}),!t)throw new Error("ProximityEffect: nodes argument is required");return e.preventCenterCalculations=!0,_classPrivateFieldSet(_assertThisInitialized(e),_params,i),e.nodes=t,e.threshold=_classPrivateFieldGet(_assertThisInitialized(e),_params).hasOwnProperty("threshold")?_classPrivateFieldGet(_assertThisInitialized(e),_params).threshold:0,e.runoff=_classPrivateFieldGet(_assertThisInitialized(e),_params).hasOwnProperty("runoff")?_classPrivateFieldGet(_assertThisInitialized(e),_params).runoff:_classPrivateFieldGet(_assertThisInitialized(e),_DEFAULT_RUNOFF),e.attack=_classPrivateFieldGet(_assertThisInitialized(e),_params).hasOwnProperty("attack")?_classPrivateFieldGet(_assertThisInitialized(e),_params).attack:1,e.decay=_classPrivateFieldGet(_assertThisInitialized(e),_params).hasOwnProperty("decay")?_classPrivateFieldGet(_assertThisInitialized(e),_params).decay:1,e.accuracy=_classPrivateFieldGet(_assertThisInitialized(e),_params).hasOwnProperty("accuracy")?_classPrivateFieldGet(_assertThisInitialized(e),_params).accuracy:_classPrivateFieldGet(_assertThisInitialized(e),_DEFAULT_ACCURACY),e.invert=_classPrivateFieldGet(_assertThisInitialized(e),_params).invert||!1,e.offsetX=_classPrivateFieldGet(_assertThisInitialized(e),_params).offsetX||0,e.offsetY=_classPrivateFieldGet(_assertThisInitialized(e),_params).offsetY||0,e.jitter=_classPrivateFieldGet(_assertThisInitialized(e),_params).jitter||0,e.direction=_classPrivateFieldGet(_assertThisInitialized(e),_params).direction||_classPrivateFieldGet(_assertThisInitialized(e),_DEFAULT_DIRECTION),e.FPS=_classPrivateFieldGet(_assertThisInitialized(e),_params).FPS||_classPrivateFieldGet(_assertThisInitialized(e),_DEFAULT_FPS),e.mode=_classPrivateFieldGet(_assertThisInitialized(e),_params).mode||_classPrivateFieldGet(_assertThisInitialized(e),_DEFAULT_MODE),e.target=_classPrivateFieldGet(_assertThisInitialized(e),_params).target,"completed"===document.readyState?_classPrivateMethodGet(_assertThisInitialized(e),_init,_init2).call(_assertThisInitialized(e)):window.addEventListener("load",function(){return _classPrivateMethodGet(_assertThisInitialized(e),_init,_init2).call(_assertThisInitialized(e))}),e}return _createClass(s,[{key:"addEffect",value:function(t,e,i,a){var s;if("string"==typeof t){if(!_classPrivateFieldGet(this,_VALID_EFFECTS).hasOwnProperty(t))throw new Error("ProximityEffect: Couldn't find preset '".concat(t,"'"));s=_classPrivateFieldGet(this,_VALID_EFFECTS)[t]}else{if(!Utils.isObject(t)||"string"!=typeof t.rule)return void console.log("".concat(t," is not a valid effect type"));s=t}"number"==typeof e&&(e=Utils.valToObj(Utils.constrain(e,t.min,t.max))),"number"==typeof i&&(i=Utils.valToObj(Utils.constrain(i,t.min,t.max))),_classPrivateFieldSet(this,_effects,_classPrivateFieldGet(this,_effects)||[]),_classPrivateFieldGet(this,_effects).push({rules:s,near:e,far:i,params:a});for(var r=0;r<_classPrivateFieldGet(this,_nodeData).length;r++){var n=this.getNodeIndexData(r,"effects")||_classPrivateMethodGet(this,_setNodeIndexData,_setNodeIndexData2).call(this,r,"effects",[]).effects,o=e.scatterMethod?e.scatterMethod:_classPrivateFieldGet(this,_DEFAULT_SCATTER_METHOD),l=i.scatterMethod?i.scatterMethod:_classPrivateFieldGet(this,_DEFAULT_SCATTER_METHOD);n.push({near:e.scatter?e.value+Utils.random(e.scatter,o):e.value,far:i.scatter?i.value+Utils.random(i.scatter,l):i.value})}}},{key:"hasEffect",value:function(e){return void 0!==this.effects.find(function(t){return t.type===e})}},{key:"removeEffect",value:function(t){if(this.hasEffect(t))for(var e=0;e<_classPrivateFieldGet(this,_effects).length;e++){_classPrivateFieldGet(this,_effects)[e].type===t&&_classPrivateFieldGet(this,_effects).splice(e,1)}}},{key:"distanceFrom",value:function(t){return this.getNodeData(t,"distance")}},{key:"distanceFromIndex",value:function(t){return this.getNodeIndexData(t,"distance")}},{key:"setCenterPoints",value:function(){for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t],i=e.style.cssText;e.style.cssText=this.getNodeIndexData(t,"style");var a=e.getBoundingClientRect(),s=.5*(a.left+a.right)-this.offsetX,r=.5*(a.top+a.bottom)-this.offsetY,n=this.getNodeIndexData(t,"jitter");n&&0<this.jitter&&(s+=n.x,r+=n.y),e.style.cssText=i,_classPrivateMethodGet(this,_setNodeIndexData,_setNodeIndexData2).call(this,t,"center",{x:s,y:r})}}},{key:"getNodeData",value:function(t,e){var i=_classPrivateFieldGet(this,_nodeData)[this.nodes.findIndex(function(t){return t===node})];return e?i[e]:i}},{key:"getNodeIndexData",value:function(t,e){return _classPrivateFieldGet(this,_nodeData)[t][e]}},{key:"hasNodeIndexData",value:function(t,e){return _classPrivateFieldGet(this,_nodeData)[t].hasOwnProperty(e)}},{key:"updatePointer",value:function(t){_classPrivateFieldGet(this,_pointer).x=t.clientX,_classPrivateFieldGet(this,_pointer).y=t.clientY}},{key:"reflowEvent",value:function(t){var e=this;t.currentTarget!==this&&this.dispatchEvent(new Event("reflow")),this.preventCenterCalculations||window.setTimeout(function(){return e.setCenterPoints()},1)}},{key:"update",value:function(){document.documentElement;for(var t=0;t<this.nodes.length;t++){var e,i=this.nodes[t],a=(i.getBoundingClientRect(),this.getNodeIndexData(t,"center")),s=a.x-(i.dataset.offsetx||0),r=a.y-(i.dataset.offsety||0),n=void 0,o=void 0,l=this.getNodeIndexData(t,"lastDelta");o=this.target?(n=.5*((e=this.target.getBoundingClientRect()).left+e.right),.5*(e.top+e.bottom)):(n=this.pointer.x,this.pointer.y);var c,u=n-s,d=o-r,f=void 0,_=void 0,f="both"===this.direction?Math.sqrt(u*u+d*d):Math.abs("horizontal"===this.direction?u:d),_=Utils.constrain((f-this.threshold)*_classPrivateFieldGet(this,_params).invRunoff,0,1);if(this.invert&&(_=1-_),_classPrivateMethodGet(this,_setNodeIndexData,_setNodeIndexData2).call(this,t,"distance",_),c=l+(_-l)*(Utils.XOR(l<_,this.invert)?this.decay:this.attack),c=Utils.roundTo(c,this.accuracy),_classPrivateMethodGet(this,_setNodeIndexData,_setNodeIndexData2).call(this,t,"lastDelta",c),0<this.effects.length){for(var h={},v=0;v<this.effects.length;v++){var p=this.effects[v],m=this.getNodeIndexData(t,"effects")[v],y=m.near,P=m.far,F=p.rules.rule,g=p.rules.func,w=p.rules.unit||"",T=Utils.delta(c,y,P);g?(h[F]||(h[F]=[]),h[F].push(g+"("+T+w+")")):i.style[F]="".concat(T).concat(w)}for(var I in h)i.style[I]=h[I].join(" ");var G=Math.floor(1e3*c);i.style.zIndex=this.invert?G:1e3-G}}"redraw"===this.mode&&window.requestAnimationFrame(this.update),this.dispatchEvent(new Event("redraw"))}},{key:"target",get:function(){return _classPrivateFieldGet(this,_params).target},set:function(t){!t||t.getBoundingClientRect()?_classPrivateFieldGet(this,_params).target=t:console.log("".concat(t," is not a valid target"))}},{key:"nodes",get:function(){return _classPrivateFieldGet(this,_nodes)},set:function(t){var e=this;if(!(t instanceof NodeList))throw new Error("".concat(t," is not a node list"));if(t.length<1)throw new Error("No nodes found in ".concat(t));_classPrivateFieldSet(this,_nodes,[].slice.call(t)),_classPrivateFieldSet(this,_nodeData,_classPrivateFieldGet(this,_nodes).map(function(t){return{node:t,style:t.style.cssText,lastDelta:_classPrivateFieldGet(e,_params).doPresetDistances?1:null}})),_classPrivateFieldGet(this,_params)&&!this.preventCenterCalculations&&this.setCenterPoints()}},{key:"effects",get:function(){return _classPrivateFieldGet(this,_effects)}},{key:"threshold",get:function(){return _classPrivateFieldGet(this,_params).threshold},set:function(t){_classPrivateFieldGet(this,_params).threshold=Utils.constrain(t,0)}},{key:"runoff",get:function(){return _classPrivateFieldGet(this,_params).runoff},set:function(t){_classPrivateFieldGet(this,_params).runoff=Utils.constrain(t,0),_classPrivateFieldGet(this,_params).invRunoff=1/_classPrivateFieldGet(this,_params).runoff}},{key:"boundary",get:function(){return this.threshold+this.runoff}},{key:"invert",get:function(){return _classPrivateFieldGet(this,_params).invert},set:function(t){_classPrivateFieldGet(this,_params).invert=!!t}},{key:"attack",get:function(){return _classPrivateFieldGet(this,_params).attack},set:function(t){_classPrivateFieldGet(this,_params).attack=Utils.constrain(t,0,1)}},{key:"decay",get:function(){return _classPrivateFieldGet(this,_params).decay},set:function(t){_classPrivateFieldGet(this,_params).decay=Utils.constrain(t,0,1)}},{key:"offsetX",get:function(){return _classPrivateFieldGet(this,_params).offsetX},set:function(t){_classPrivateFieldGet(this,_params).offsetX=t,this.preventCenterCalculations||this.setCenterPoints()}},{key:"offsetY",get:function(){return _classPrivateFieldGet(this,_params).offsetY},set:function(t){_classPrivateFieldGet(this,_params).offsetY=t,this.preventCenterCalculations||this.setCenterPoints()}},{key:"jitter",get:function(){return _classPrivateFieldGet(this,_params).jitter},set:function(t){_classPrivateFieldGet(this,_params).jitter=Utils.constrain(t,0);for(var e=0;e<this.nodes.length;e++)_classPrivateMethodGet(this,_setNodeIndexData,_setNodeIndexData2).call(this,e,"jitter",{x:Utils.random(this.jitter),y:Utils.random(this.jitter)});this.preventCenterCalculations||this.setCenterPoints()}},{key:"direction",get:function(){return _classPrivateFieldGet(this,_params).direction},set:function(t){_classPrivateFieldGet(this,_VALID_DIRECTIONS).has(t)?_classPrivateFieldGet(this,_params).direction=t:console.log("".concat(t," not a valid direction."))}},{key:"FPS",get:function(){return _classPrivateFieldGet(this,_params).FPS},set:function(t){0<t?_classPrivateFieldGet(this,_params).FPS=Utils.constrain(t,0):console.log("Invalid FPS requested.")}},{key:"mode",get:function(){return _classPrivateFieldGet(this,_params).mode},set:function(t){if(t){if(t===_classPrivateFieldGet(this,_params).mode)return void console.log("Already in ".concat(t," mode. Mode not changed."));var e=document.body;switch(t){case"mousemove":e.addEventListener("mousemove",this.update());break;case"enterframe":e.addEventListener("enterframe",this.update()),this._frameLoop=window.setInterval(function(){return e.dispatchEvent(new Event("enterframe"))},1e3/this.FPS);break;case"redraw":break;default:return void console.log("".concat(t," is not a recognised mode."))}_classPrivateFieldGet(this,_params).mode=t}}},{key:"accuracy",get:function(){return _classPrivateFieldGet(this,_params).accuracy},set:function(t){_classPrivateFieldGet(this,_params).accuracy=Math.floor(Utils.constrain(t,0))}},{key:"pointer",get:function(){return{x:_classPrivateFieldGet(this,_pointer).x,y:_classPrivateFieldGet(this,_pointer).y}}}]),s}(),_init2=function(){this.preventCenterCalculations=!1,this.setCenterPoints(),this.update=this.update.bind(this),window.addEventListener("scroll",this.reflowEvent.bind(this)),window.addEventListener("resize",this.reflowEvent.bind(this)),document.addEventListener("mousemove",this.updatePointer.bind(this)),document.dispatchEvent(new MouseEvent("mousemove")),this.dispatchEvent(new Event("ready")),window.requestAnimationFrame(this.update)},_setNodeIndexData2=function(t,e,i){return _classPrivateFieldGet(this,_nodeData)[t]||(_classPrivateFieldGet(this,_nodeData)[t]={}),_classPrivateFieldGet(this,_nodeData)[t][e]=i,_classPrivateFieldGet(this,_nodeData)[t]};