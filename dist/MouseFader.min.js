"use strict";var _VALID_EFFECTS,_createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var VALID_MODES=new Set(["mousemove","enterframe","redraw"]),VALID_DIRECTIONS=new Set(["both","horizontal","vertical"]),DEFAULT_MODE="redraw",DEFAULT_ACCURACY=10,DEFAULT_DIRECTION="both",DEFAULT_FPS=5,DEFAULT_RUNOFF=100,DEFAULT_ATTACK=1,DEFAULT_DECAY=1,VALID_EFFECTS=(_defineProperty(_VALID_EFFECTS={opacity:{min:0,max:1,rule:"opacity"},translateX:{rule:"transform",func:"translateX",unit:"px"},translateY:{rule:"transform",func:"translateY",unit:"px"},translateZ:{rule:"transform",func:"translateZ",unit:"px"},rotate:{rule:"transform",func:"rotate",unit:"deg"},rotateX:{rule:"transform",func:"rotateX",unit:"deg"},rotateY:{rule:"transform",func:"rotateY",unit:"deg"},rotateZ:{rule:"transform",func:"rotateZ",unit:"deg"},scale:{rule:"transform",func:"scale"},scaleX:{rule:"transform",func:"scaleX"},scaleY:{rule:"transform",func:"scaleY"}},"scaleY",{rule:"transform",func:"scaleY"}),_defineProperty(_VALID_EFFECTS,"skewX",{rule:"transform",func:"skewX",unit:"deg"}),_defineProperty(_VALID_EFFECTS,"skewY",{rule:"transform",func:"skewY",unit:"deg"}),_defineProperty(_VALID_EFFECTS,"perspective",{rule:"transform",func:"perspective",unit:"px"}),_defineProperty(_VALID_EFFECTS,"blur",{min:0,rule:"filter",func:"blur",unit:"px"}),_defineProperty(_VALID_EFFECTS,"brightness",{min:0,rule:"filter",func:"brightness",unit:"%"}),_defineProperty(_VALID_EFFECTS,"contrast",{min:0,rule:"filter",func:"contrast",unit:"%"}),_defineProperty(_VALID_EFFECTS,"grayscale",{min:0,max:100,rule:"filter",func:"grayscale",unit:"%"}),_defineProperty(_VALID_EFFECTS,"hueRotate",{rule:"filter",func:"hue-rotate",unit:"deg"}),_defineProperty(_VALID_EFFECTS,"invert",{min:0,max:100,rule:"filter",func:"invert",unit:"%"}),_defineProperty(_VALID_EFFECTS,"saturate",{min:0,max:100,rule:"filter",func:"saturate",unit:"%"}),_defineProperty(_VALID_EFFECTS,"sepia",{min:0,max:100,rule:"filter",func:"sepia",unit:"%"}),_VALID_EFFECTS),_target=void 0,_nodes=void 0,_centers=void 0,_params=void 0,_effects=void 0,_pointer={},_lastDeltas=void 0,_frameLoop=void 0,constrain=function(t,e,n){return"number"!=typeof t?NaN:(null!=e&&"number"==typeof e&&(t=Math.max(t,e)),null!=n&&"number"==typeof n&&(t=Math.min(t,n)),t)},roundTo=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=Math.pow(e+1,10);return Math.round(t*n)/n},delta=function(t,e,n){return(n-e)*t+e},map=function(t,e,n,r,a){return(t-e)*(a-r)/(n-e)+r},XOR=function(t,e){return(t||e)&&!(t&&e)},MouseFader=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,n),this.target=t,_params=e,this.threshold=_params.hasOwnProperty("threshold")?_params.threshold:0,this.runoff=_params.hasOwnProperty("runoff")?_params.runoff:DEFAULT_RUNOFF,this.attack=_params.hasOwnProperty("attack")?_params.attack:1,this.decay=_params.hasOwnProperty("decay")?_params.decay:1,this.accuracy=_params.hasOwnProperty("accuracy")?_params.accuracy:DEFAULT_ACCURACY,this.invert=_params.invert||!1,this.offsetX=_params.offsetX||0,this.offsetY=_params.offsetY||0,this.jitter=_params.jitter||0,this.direction=_params.direction||DEFAULT_DIRECTION,this.FPS=_params.FPS||DEFAULT_FPS,this.mode=_params.mode||DEFAULT_MODE,this.init()}return _createClass(n,[{key:"addEffect",value:function(t,e,n){var r=void 0;if(0<(arguments.length<=3?0:arguments.length-3))r={rule:arguments.length<=3?void 0:arguments[3],func:arguments.length<=4?void 0:arguments[4],unit:arguments.length<=5?void 0:arguments[5]};else{if(!VALID_EFFECTS.hasOwnProperty(t))return void console.log(t+" is not a supported effect type");r=VALID_EFFECTS[t]}(_effects=_effects||[]).push({type:t,near:constrain(e,r.min,r.max),far:null!=n?constrain(n,r.min,r.max):e,rule:r.rule,func:r.func,unit:r.unit})}},{key:"hasEffect",value:function(t){}},{key:"effect",value:function(t){}},{key:"removeEffect",value:function(t){}},{key:"init",value:function(){document.addEventListener("mousemove",this.updatePointer),document.dispatchEvent(new MouseEvent("mousemove")),window.addEventListener("scroll",this.windowEvent.bind(this)),window.addEventListener("resize",this.windowEvent.bind(this)),this.update=this.update.bind(this),window.requestAnimationFrame(this.update)}},{key:"setCenters",value:function(){_centers=[];for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t].getBoundingClientRect();_centers.push({x:.5*(e.left+e.right),y:.5*(e.top+e.bottom)})}}},{key:"setJitterValues",value:function(){for(var t=0;t<this.nodes.length;t++)0<this.jitter?(this.nodes[t].dataset.jitterx=(Math.random()-.5)*this.jitter,this.nodes[t].dataset.jittery=(Math.random()-.5)*this.jitter):this.nodes[t].dataset.jitterx&&(delete this.nodes[t].dataset.jitterx,delete this.nodes[t].dataset.jittery)}},{key:"updatePointer",value:function(t){_pointer.x=t.clientX,_pointer.y=t.clientY}},{key:"windowEvent",value:function(t){this.setCenters()}},{key:"update",value:function(t){for(var e=document.documentElement,n=0;n<this.nodes.length;n++){var r=this.nodes[n],a=_lastDeltas[n],i=r.getBoundingClientRect();if(0<=i.right&&i.left<=e.clientWidth&&0<=i.bottom&&i.top<=e.clientHeight||a<1){var o=_centers[n].x-this.offsetX-(r.dataset.jitterx||0),s=_centers[n].y-this.offsetY-(r.dataset.jittery||0),u=_pointer.x-o,c=_pointer.y-s,f=void 0,l=void 0,d=void 0;if(f="both"===this.direction?Math.sqrt(u*u+c*c):Math.abs("horizontal"===this.direction?u:c),l=constrain((f-this.threshold)/this.runoff,0,1),this.invert&&(l=1-l),d=a?a+(l-a)*(XOR(a<l,this.invert)?this.decay:this.attack):l,(d=roundTo(d,this.accuracy))<=1){for(var h={},_=0;_<_effects.length;_++){var m=_effects[_],p=(m.type,m.near),y=m.far,v=m.rule,E=m.func,g=m.unit||"",F=delta(d,p,y);E?(h[v]||(h[v]=[]),h[v].push(E+"("+F+g+")")):r.style[v]=""+F+g}for(var D in h)r.style[D]=h[D].join(" ");r.style.zIndex=1e3-Math.floor(1e3*d)}_lastDeltas[n]=d}}"redraw"===this.mode&&window.requestAnimationFrame(this.update)}},{key:"target",get:function(){return _target},set:function(t){var e=void 0;if(t instanceof HTMLElement){if(console.log("HTMLElement with "+t.children.length+" children found"),t.children.length<1){var n=document.createElement("span");t.parentNode.insertBefore(n,t),n.appendChild(t),t=n}e=t.children}else{if(!(t instanceof NodeList))return void console.log(t+" is not a suitable target");console.log("NodeList with "+t.length+" childNodes found"),e=t}e.length<1?console.log("No children found on "+t):(this.nodes=e,this.setCenters(),_lastDeltas=new Array(this.nodes.length))}},{key:"threshold",get:function(){return _params.threshold},set:function(t){_params.threshold=constrain(t,0)}},{key:"runoff",get:function(){return _params.runoff},set:function(t){_params.runoff=constrain(t,0)}},{key:"boundary",get:function(){return this.threshold+this.runoff}},{key:"invert",get:function(){return _params.invert},set:function(t){_params.invert=!!t}},{key:"attack",get:function(){return _params.attack},set:function(t){_params.attack=constrain(t,0,1)}},{key:"decay",get:function(){return _params.decay},set:function(t){_params.decay=constrain(t,0,1)}},{key:"offsetX",get:function(){return _params.offsetX},set:function(t){_params.offsetX=t}},{key:"offsetY",get:function(){return _params.offsetY},set:function(t){_params.offsetY=t}},{key:"jitter",get:function(){return _params.jitter},set:function(t){_params.jitter=constrain(t,0),this.setJitterValues()}},{key:"direction",get:function(){return _params.direction},set:function(t){VALID_DIRECTIONS.has(t)?_params.direction=t:console.log(t+" not a valid direction.")}},{key:"FPS",get:function(){return _params.FPS},set:function(t){0<t&&"number"==typeof t?_params.FPS=constrain(t,0):console.log("Invalid FPS requested")}},{key:"mode",get:function(){return _params.mode},set:function(t){t!==_params.mode?VALID_MODES.has(t)?_params.mode=t:console.log(t+" not a recognised mode."):console.log("Already in "+t+" mode. Mode not changed.")}},{key:"accuracy",get:function(){return _params.accuracy},set:function(t){_params.accuracy=Math.floor(constrain(t,0))}}]),n}();